syntax = "proto3";

package protos;

import "connect.proto";
import "records/kafka.proto";
import "common/auth.proto";
import "records/base.proto";
import "common/status.proto";
import "encoding/options.proto";

option go_package = "github.com/batchcorp/plumber-schemas/build/go/protos";

message WriteRequest {
    // Every gRPC request must have a valid auth config
    common.Auth auth = 9999;

    // Semi-required; either set this or connection_config. If set, connection_config
    // will be ignored.
    string connection_id = 1;

    // Semi-required; either set this or connection_id. This is generally used
    // for creating ephemeral connections (ie. via CLI).
    protos.ConnectionConfig connection_config = 2;

    // We need to use a WriteRecord as a wrapper since there is no way to "repeated oneof ..."
    repeated records.WriteRecord records = 3;

    // Specifying encoding options will cause the _value_ of the record to get
    // encoded and set in WriteRecord.encoded.
    encoding.Options encode_options = 4;
}

message WriteResponse {
    common.Status status = 1000;
}
